---
title: "Photo Album"
permalink: /photo.html
---

{% include head.html %}

<body id="page-top" class="photo-page">
  {% include nav.html %}

  <section id="photos" class="content-section bg-light">
    <div class="container">
      <div class="content-section-heading text-center">
        <h2 class="mb-5">Family Memories</h2>
      </div>

      <div class="photo-grid" aria-live="polite">
        {%- assign items = site.data.photos | default: empty -%}
        {%- for p in items -%}
          {%- assign base = p.base -%}
          {%- assign caption = p.caption | default: '' -%}
          {%- assign thumb800  = p.thumb800  | default: base | replace: '.jpg','_800.jpg'  | replace: '.jpeg','_800.jpeg' | replace: '.png','_800.png' -%}
          {%- assign thumb1200 = p.thumb1200 | default: base | replace: '.jpg','_1200.jpg' | replace: '.jpeg','_1200.jpeg'| replace: '.png','_1200.png' -%}

          <div class="photo-item"
               tabindex="0"
               role="button"
               aria-label="Open photo"
               data-full="{{ base | relative_url }}"
               data-caption="{{ caption | escape }}">
            <img class="photo-img"
                 loading="lazy"
                 decoding="async"
                 fetchpriority="low"
                 src="{{ thumb800   | relative_url }}"
                 srcset="{{ thumb800 | relative_url }} 800w, {{ thumb1200 | relative_url }} 1200w"
                 sizes="(min-width: 992px) 31vw, (min-width: 576px) 48vw, 100vw"
                 alt="{{ caption | default: 'Family Photo' | escape }}">
          </div>
        {%- endfor -%}
      </div>
    </div>
  </section>

  <!-- 확대 보기 (모달) - 헤더 제거 버전 -->
  <div class="modal fade" id="photoModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content no-header">
        <div class="modal-body d-flex align-items-center justify-content-center p-0">
          <figure class="modal-figure m-0">
            <img class="modal-img" src="" alt="Enlarged Photo">
            <figcaption class="modal-caption"></figcaption>
          </figure>
        </div>
      </div>
    </div>
  </div>

  {% include scripts.html %}

  <!-- Masonry & imagesLoaded -->
  <script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/imagesloaded@4.1.4/imagesloaded.pkgd.min.js"></script>

  <style>
    /* ===============  Warm theme (scoped to this page)  =============== */
    body.photo-page {
      --warm-bg1:#fff7f0; --warm-bg2:#ffe9d6; --warm-accent:#b25c2e;
      --card-bg:#fffaf6; --card-shadow:0 8px 24px rgba(178,92,46,0.12);
      --text-strong:#3b2a22; --text-soft:#6b5247;
      background: linear-gradient(180deg, var(--warm-bg1), var(--warm-bg2));
      color: var(--text-strong);
    }
    body.photo-page .content-section-heading h2 { color: var(--text-strong); letter-spacing:.2px; }
    .photo-grid { margin: 0 auto; }

    /* 정사각형 타일 + 스켈레톤 로더 */
    .photo-item {
      width: 31%;
      aspect-ratio: 1 / 1;
      margin-bottom: 12px;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: var(--card-shadow);
      background: var(--card-bg);
      position: relative;
      cursor: zoom-in;
      transform: translateZ(0);
    }
    @media (max-width: 992px) { .photo-item { width: 48%; } }
    @media (max-width: 576px) { .photo-item { width: 100%; } }

    /* Skeleton shimmer placeholder while image loads (prevents ? & pop-in) */
    .photo-item::before {
      content: "";
      position: absolute; inset: 0;
      background: linear-gradient(90deg, rgba(255,255,255,0.2), rgba(255,255,255,0.5), rgba(255,255,255,0.2));
      background-size: 200% 100%;
      animation: shimmer 1.3s infinite;
    }
    @keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }

    .photo-item img.photo-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transform-origin: center;
      animation: kenburns 14s ease-in-out infinite alternate;
      animation-play-state: paused;
      display: block;
      opacity: 0;                 /* hide while loading to avoid broken icon flash */
      transition: opacity .25s ease;
    }
    .photo-item.is-loaded::before { display: none; }
    .photo-item.is-loaded img.photo-img { opacity: 1; }

    @keyframes kenburns {
      0%   { transform: scale(1.02) translate3d(-1%, -1%, 0); }
      100% { transform: scale(1.05) translate3d( 1%,  1%, 0); }
    }

    /* Modal: centered, warm, no scrollbars next to image */
    #photoModal .modal-dialog { width:auto; max-width:100vw; margin:1rem auto; }
    #photoModal .modal-content.no-header {
      max-height: calc(100vh - 2rem);
      display:flex; flex-direction:column; align-items:center;
      background:#000; border-radius:18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.3);
    }
    #photoModal .modal-body { padding:0; overflow:hidden; width:100%; height:100%; }
    #photoModal .modal-figure { position:relative; max-width:100%; max-height:100%; }
    #photoModal .modal-img { display:block; max-width:100%; height:auto; touch-action:manipulation; }
    #photoModal .modal-caption {
      position:absolute; left:0; right:0; bottom:0;
      padding:.55rem .85rem; color:#ffe9d6;
      background:linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.55) 80%);
      font-size:.95rem; line-height:1.35; letter-spacing:.1px;
      max-height:34%; overflow:hidden; text-overflow:ellipsis;
    }
  </style>

  <script>
    (function($){
      $(function () {
        var $grid = $('.photo-grid');

        // Masonry once images have dimensions
        $grid.imagesLoaded(function () {
          $grid.masonry({ itemSelector: '.photo-item', percentPosition: true, gutter: 12 });
        });

        // 1) TILE LOADING: remove '?' flash using skeleton + fade-in after onload
        document.querySelectorAll('.photo-item img.photo-img').forEach(function(img){
          var item = img.closest('.photo-item');
          function markLoaded(){ item && item.classList.add('is-loaded'); }
          if (img.complete && img.naturalWidth) { markLoaded(); }
          else {
            img.addEventListener('load', markLoaded, { once:true });
          }
          // Fallback on error: switch to full and then mark loaded
          img.addEventListener('error', function(){
            var fallback = item.getAttribute('data-full');
            if (img.src !== fallback) {
              img.removeAttribute('srcset'); img.removeAttribute('sizes');
              img.src = fallback;
            } else { markLoaded(); }
          }, { once:true });
        });

        // Utility: debounce
        function debounce(fn, delay){ var t; return function(){ clearTimeout(t); var a=arguments,s=this; t=setTimeout(function(){ fn.apply(s,a); }, delay); }; }

        // Modal logic
        var $modal = $('#photoModal');
        var $modalImg = $modal.find('.modal-img');
        var $modalCaption = $modal.find('.modal-caption');

        // 2) MODAL OPEN without rescale flicker: preload -> compute -> set -> show
        function computeFit(nw, nh){
          var vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
          var vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
          var outerMargin = 32;                 // dialog margin
          var maxW = vw - outerMargin * 2;
          var maxH = vh - outerMargin * 2;      // caption overlays image (absolute), so ignore its height
          var scale = Math.min(1, maxW / nw, maxH / nh);
          return Math.floor(nw * scale);
        }

        function openModalWithFit(src, caption){
          var preload = new Image();
          preload.onload = function(){
            var targetW = computeFit(preload.naturalWidth, preload.naturalHeight);
            $modalImg.css({ width: targetW + 'px' }).attr('src', src);
            $modalCaption.text(caption || '');
            $modal.find('.modal-content').css('max-width', targetW + 'px');
            $modal.modal('show'); // show after size set -> no "uleoreong"
          };
          preload.onerror = function(){ $modalImg.attr('src', src); $modalCaption.text(caption||''); $modal.modal('show'); };
          preload.src = src;
        }

        // Resize handling (kept, but only when the user resizes)
        var refit = debounce(function(){
          var img = $modalImg[0]; if(!img || !img.naturalWidth) return;
          var targetW = computeFit(img.naturalWidth, img.naturalHeight);
          $modalImg.css({ width: targetW + 'px' });
          $modal.find('.modal-content').css('max-width', targetW + 'px');
        }, 120);

        // Open handlers
        $grid.on('click keydown', '.photo-item', function (e) {
          if (e.type === 'keydown' && e.key !== 'Enter' && e.key !== ' ') return;
          var src = this.dataset.full;
          var caption = this.dataset.caption || '';
          openModalWithFit(src, caption);
        });

        // Close on click (image or backdrop content)
        $modal.on('click', '.modal-img, .modal-content', function(){ $modal.modal('hide'); });

        // Refit on viewport changes (no flicker since size is recomputed in-place)
        $(window).on('resize orientationchange', refit);
        if ('visualViewport' in window) {
          window.visualViewport.addEventListener('resize', refit, { passive:true });
        }

        // Ken Burns only when visible
        if ('IntersectionObserver' in window) {
          var io = new IntersectionObserver(function(entries){
            entries.forEach(function(entry){
              var img = entry.target.querySelector('img.photo-img');
              if (!img) return;
              img.style.animationPlayState = entry.isIntersecting ? 'running' : 'paused';
            });
          }, { rootMargin: '200px' });
          document.querySelectorAll('.photo-item').forEach(function(item){ io.observe(item); });
        }
      });
    })(jQuery);
  </script>
</body>
</html>
